"""
–§–∞–π–ª—ã –≤ —Ñ–∞–π–ª–µ üå∂Ô∏èüå∂Ô∏è

–í–∞–º –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª files.txt, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–π–ª–∞—Ö.
–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —Ñ–∞–π–ª–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏—è, —Ä–∞–∑–¥–µ–ª–µ–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª–æ–º –ø—Ä–æ–±–µ–ª–∞
‚Äî –∏–º—è —Ñ–∞–π–ª–∞, –µ–≥–æ —Ä–∞–∑–º–µ—Ä (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ) –∏ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è:

cant-help-myself.mp3 7 MB
keep-yourself-alive.mp3 6 MB
bones.mp3 5 MB
...
–ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É, –∫–æ—Ç–æ—Ä–∞—è –≥—Ä—É–ø–ø–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é, –æ–ø—Ä–µ–¥–µ–ª—è—è –æ–±—â–∏–π –æ–±—ä–µ–º —Ñ–∞–π–ª–æ–≤ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã,
–∏ –≤—ã–≤–æ–¥–∏—Ç –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –≥—Ä—É–ø–ø—ã —Ñ–∞–π–ª–æ–≤, —É–∫–∞–∑—ã–≤–∞—è –¥–ª—è –∫–∞–∂–¥–æ–π –µ–µ –æ–±—â–∏–π –æ–±—ä–µ–º. –ì—Ä—É–ø–ø—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤
–ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –Ω–∞–∑–≤–∞–Ω–∏–π —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π, —Ñ–∞–π–ª—ã –≤ –≥—Ä—É–ø–ø–∞—Ö ‚Äî –≤ –ª–µ–∫—Å–∏–∫–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ –∏—Ö –∏–º–µ–Ω.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 1. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –±—ã —Ñ–∞–π–ª files.txt –∏–º–µ–ª –≤–∏–¥:
input.txt 3000 B
scratch.zip 300 MB
output.txt 1 KB
temp.txt 4 KB
boy.bmp 2000 KB
mario.bmp 1 MB
data.zip 900 MB

—Ç–æ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã–ª–∞ –±—ã –≤—ã–≤–µ—Å—Ç–∏:
boy.bmp
mario.bmp
----------
Summary: 3 MB

input.txt
output.txt
temp.txt
----------
Summary: 8 KB

data.zip
scratch.zip
----------
Summary: 1 GB

–≥–¥–µ Summary ‚Äî –æ–±—â–∏–π –æ–±—ä–µ–º —Ñ–∞–π–ª–æ–≤ –≥—Ä—É–ø–ø—ã.

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 2. –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è, —á—Ç–æ –≤—Å–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ —Å–æ–¥–µ—Ä–∂–∞—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ.
–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 3. –û–±—â–∏–π –æ–±—ä–µ–º —Ñ–∞–π–ª–æ–≤ –≥—Ä—É–ø–ø—ã –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ —Å–∞–º—ã—Ö –∫—Ä—É–ø–Ω—ã—Ö (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö)
–µ–¥–∏–Ω–∏—Ü–∞—Ö –∏–∑–º–µ—Ä–µ–Ω–∏—è —Å –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ–º –¥–æ —Ü–µ–ª—ã—Ö. –î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, —Å–Ω–∞—á–∞–ª–∞ —Å–ª–µ–¥—É–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—É–º–º–∞—Ä–Ω—ã–π –æ–±—ä–µ–º
–≤—Å–µ—Ö —Ñ–∞–π–ª–æ–≤ –≥—Ä—É–ø–ø—ã, —Å–∫–∞–∂–µ–º, –≤ –±–∞–π—Ç–∞—Ö, –∞ –∑–∞—Ç–µ–º –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ —Å–∞–º—ã–µ –∫—Ä—É–ø–Ω—ã–µ (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –≤–æ–∑–º–æ–∂–Ω—ã–µ)
–µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è.

–ü—Ä–∏–º–µ—Ä—ã –ø–µ—Ä–µ–≤–æ–¥–∞:
    1023 B -> 1023 B
    1300 B -> 1 KB
    1900 B -> 2 KB

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ 4. –ó–Ω–∞—á–µ–Ω–∏—è –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è —Ç–∞–∫–∏–µ –∂–µ, –∫–∞–∫–∏–µ –ø—Ä–∏–Ω—è—Ç—ã –≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–µ:

    1 KB = 1024 B
    1 MB = 1024 KB
    1 GB = 1024 MB

"""
from math import floor, log

units = {'B': 1, 'KB': 1024, 'MB': 1024 ** 2, 'GB': 1024 ** 3}
f_list = {}


def get_unit_name(size: int) -> str:
    """–ü—Ä–∏–Ω–∏–º–∞–µ—Ç —á–∏—Å–ª–æ –≤ –±–∞–π—Ç–∞—Ö –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á–∏—Å–ª–æ –≤ B, KB, MB, GB"""
    unit_names = ('B', 'KB', 'MB', 'GB', 'TB')
    pwr = floor(log(size, 1024))
    return f'{size / 1024 ** pwr:.0f} {unit_names[pwr]}'


with open('files.txt', encoding='utf-8') as file:
    for s in file:
        f = s.split()
        f_name, f_ext = f[0].split('.')
        f_size = int(f[1]) * units.get(f[2])
        f_list[f_ext] = f_list.get(f_ext, {}) | {f_name: f_size}

for k, v in sorted(f_list.items()):
    [print(f'{s}.{k}') for s in sorted(v.keys())]
    print('-' * 10)
    total_size = sum(i for i in v.values())
    print(f'Summary: {get_unit_name(total_size)}')
    print()
